<!doctype html>
<html lang="tr" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Morpheradan Notlar â€“ WeAreMorphera</title>
  <meta name="description" content="WeAreMorphera ekibinin dÃ¼ÅŸÃ¼nce duvarÄ±, notlarÄ± ve perde arkasÄ± paylaÅŸÄ±mlarÄ±.">
  <link rel="stylesheet" href="assets/css/styles.css?v=5" />
</head>
<body class="page-notes">

<!-- HEADER: index.html ile aynÄ±, sadece Morpheradan Notlar linki notes.html'e gider -->
<header class="header">
  <div class="container header__inner">

    <div class="header__row header__row--top">
      <a class="brand brand--pill" href="index.html#top" aria-label="WeAreMorphera anasayfa">
        <img
          src="assets/img/logo/morphera.png"
          alt="WeAreMorphera Logo"
          class="brand__logo"
          loading="lazy"
        />
        <span class="brand__text">WeAreMorphera</span>
      </a>

      <a href="index.html#socials" class="social-cta only-desktop" id="openSocial" aria-label="Sosyal Medya HesaplarÄ±mÄ±z">
        <span class="social-cta__label">Sosyal Medya HesaplarÄ±mÄ±z</span>
        <span class="social-cta__arrow" aria-hidden="true">
          <svg viewBox="0 0 24 24" width="20" height="20">
            <path d="M5 12h12M13 6l6 6-6 6"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"/>
          </svg>
        </span>
      </a>

      <div class="header__cta only-desktop" id="socials" aria-label="Sosyal baÄŸlantÄ±lar">
        <a class="lottie-icon" id="iconTikTok" href="https://www.tiktok.com/@wearemorpheraagency" target="_blank" aria-label="TikTok"></a>
        <a class="lottie-icon" id="iconInstagram" href="http://instagram.com/wearemorphera" target="_blank" aria-label="Instagram"></a>
        <a class="lottie-icon" id="iconYouTube" href="https://www.youtube.com/@wemorphera" target="_blank" aria-label="YouTube"></a>
        <a class="lottie-icon" id="iconFacebook" href="http://facebook.com/WeAreMorpheraDijitalAjans" target="_blank" aria-label="Facebook"></a>
        <a class="lottie-icon" id="iconX" href="http://x.com/WeAreMorphera" target="_blank" aria-label="X"></a>
        <a class="lottie-icon" id="iconNsosyal" href="https://sosyal.teknofest.app/@wearemorpherasosyalmedyaajansi" target="_blank" aria-label="NSosyal"></a>
      </div>

      <button class="quote-btn" id="openQuote" type="button" aria-label="HÄ±zlÄ± Teklif Formu AÃ§">
        <img
          src="assets/img/logo/teklif.png"
          alt="Teklif Al"
          class="quote-btn__icon"
          loading="lazy"
        />
      </button>
    </div>

    <div class="header__row header__row--bottom">
      <nav class="nav" id="nav" aria-label="Ana menÃ¼">
        <a href="index.html#services">Hizmetler</a>
        <a href="index.html#resultsTable">BaÅŸarÄ± Tablomuz</a>
        <a href="team.html">Ekibimiz</a>
        <a href="index.html#process">SÃ¼reÃ§</a>
        <a href="index.html#plans">Paketler</a>
        <a href="index.html#work">PortfÃ¶y</a>
        <a href="index.html#blog">Blog</a>
        <a href="contact.html" class="btn btn--ghost" rel="noopener">Ä°letiÅŸim</a>
        <a href="notes.html" aria-current="page">Morpheradan Notlar</a>
      </nav>
    </div>

  </div>
</header>

<main class="section">
  <div class="container">

    <!-- HERO / BAÅLIK BLOÄU -->
    <section class="notes-hero">
      <div class="notes-hero__badge">AjansÄ±n DÃ¼ÅŸÃ¼nce DuvarÄ±</div>
      <h1 class="notes-hero__title">Morpheradan Notlar</h1>
      <p class="notes-hero__subtitle">
        WeAreMorphera Ã§ekirdek ekibinin; fikirlerini, yol hikÃ¢yesini ve perde arkasÄ± notlarÄ±nÄ±
        paylaÅŸtÄ±ÄŸÄ± kÃ¼Ã§Ã¼k bir iÃ§ duvar. ÃœÃ§ kiÅŸi yazÄ±yor, herkes okuyabiliyor.
      </p>
      <div class="notes-hero__meta">
        <span>ğŸ‘¥ Yazarlar: Bulut, BÃ¼ÅŸra, Emine</span>
        <span>ğŸ§± Format: Tweet benzeri kartlar</span>
        <span>ğŸ¨ Stil: WeAreMorphera gradient + cam efekt</span>
      </div>
    </section>

    <!-- LAYOUT: SOL DUVAR, SAÄ ADMIN PANELÄ° -->
    <section class="notes-layout">
      <!-- SOL: Herkese aÃ§Ä±k duvar -->
      <div class="notes-feed" id="notesFeed" aria-live="polite">
        <!-- JS ile doldurulacak -->
      </div>

      <!-- SAÄ: Admin KÃ¶ÅŸesi -->
      <aside class="notes-sidebar">
        <!-- LOGIN PANELÄ° -->
        <div class="notes-login" id="notesLogin">
          <h2 class="notes-login__title">Admin KÃ¶ÅŸesi</h2>
          <p class="notes-login__subtitle">
            <strong>UyarÄ±:</strong> Bu alan sadece site kurucularÄ± iÃ§indir.
            <br/>Bulut, BÃ¼ÅŸra ve Emine harici giriÅŸ yapÄ±lmamasÄ± rica olunur. ğŸ™‚
          </p>

          <form id="loginForm" class="notes-login__form" autocomplete="off">
            <label>
              KullanÄ±cÄ± AdÄ±
              <input name="username" placeholder="bulutkeles" required />
            </label>
            <label>
              Åifre
              <input name="password" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" required />
            </label>
            <button class="btn btn--primary" type="submit">Panele GiriÅŸ Yap</button>
            <p class="notes-login__error" id="loginError" aria-live="polite"></p>
          </form>
        </div>

        <!-- GÄ°RÄ°Å SONRASI PANEL -->
        <div class="notes-admin hidden" id="notesAdmin">
          <div class="notes-admin__header">
            <div class="notes-admin__avatar-wrap">
              <div class="notes-admin__avatar" id="adminAvatar"></div>
            </div>
            <div>
              <p class="notes-admin__hello" id="adminHello"></p>
              <p class="notes-admin__role" id="adminRole"></p>
            </div>
          </div>

          <p class="notes-admin__hint">
            Buradan kÄ±sa notlar, mini tweetâ€™ler veya gÃ¶rsel eÅŸliÄŸinde aklÄ±na gelenleri
            duvara bÄ±rakabilirsin. YalnÄ±zca giriÅŸ yapan yazar; kendi notlarÄ±nÄ±
            dÃ¼zenleyip silebilir.
          </p>

          <!-- NOT FORMU -->
          <form id="noteForm" class="notes-noteform">
            <label>
              Not / DÃ¼ÅŸÃ¼nce *
              <textarea id="noteText" required
                placeholder="KÄ±sa, net, iÃ§ten bir not yaz..."></textarea>
            </label>
            <label>
              GÃ¶rsel Linki (opsiyonel)
              <input id="noteImageUrl" placeholder="https://... .webp / .jpg" />
            </label>
            <input type="hidden" id="editingId" value="" />
            <div class="notes-noteform__actions">
              <small>Not: Åu an notlar tarayÄ±cÄ±da saklanÄ±r. Ortak sunucu tarafÄ± iÃ§in backend ekleyebiliriz.</small>
              <button class="btn btn--primary" type="submit">Kaydet</button>
            </div>
          </form>
        </div>
      </aside>
    </section>

  </div>
</main>

<!-- FOOTER -->
<footer class="footer">
  <div class="container footer__inner">
    <div class="footer__links">
      <a href="#">KVKK</a>
      <a href="#">Ã‡erez PolitikasÄ±</a>
      <a href="#">Hizmet KoÅŸullarÄ±</a>
      <span>Â© <span id="year"></span> WeAreMorphera</span>
    </div>
  </div>
</footer>

<!-- Ana JS (header, lottie vs) -->
<script src="assets/js/main.js" defer></script>

<!-- Morpheradan Notlar sayfasÄ±na Ã¶zel JS -->
<!-- Ana JS (header vs.) -->
<script src="assets/js/main.js" defer></script>

<!-- Morpheradan Notlar sayfasÄ±na Ã¶zel JS (FIRESTORE) -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
 import {
  getFirestore,
  collection,
  addDoc,
  getDocs,
  doc,
  updateDoc,
  deleteDoc,
  query,
  orderBy,
  serverTimestamp
} from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";




  // === BURAYA KENDÄ° FIREBASE CONFIG'Ä°NÄ° YAPIÅTIR ===
  const firebaseConfig = {
  apiKey: "AIzaSyCoLU3FES5QdNoD1WOHz9M7Z01U63hkn4U",
  authDomain: "morpheranotes.firebaseapp.com",
  projectId: "morpheranotes",
  storageBucket: "morpheranotes.firebasestorage.app",
  messagingSenderId: "756772520204",
  appId: "1:756772520204:web:b686f9f69f860098a10929",
  measurementId: "G-CLH7TE7TNP"
};

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const notesColRef = collection(db, "morpheraNotes"); // koleksiyon adÄ±
// === BEÄENÄ° EKLE ===
    // === BEÄENÄ° / YORUM KAYDETME ===
    async function addLike(noteId, userName) {
      const likeRef = collection(db, "morpheraNotes", noteId, "likes");
      await addDoc(likeRef, {
        name: userName,
        createdAt: serverTimestamp()
      });
    }

    async function addComment(noteId, userName, commentText) {
      const commentsRef = collection(db, "morpheraNotes", noteId, "comments");
      await addDoc(commentsRef, {
        name: userName,
        comment: commentText,
        createdAt: serverTimestamp()
      });
    }


// === YORUM EKLE ===
async function addComment(noteId, userName, commentText) {
  const commentsRef = collection(db, "morpheraNotes", noteId, "comments");
  await addDoc(commentsRef, {
    name: userName,
    comment: commentText,
    createdAt: serverTimestamp()
  });
  loadNotes();
}

  document.addEventListener("DOMContentLoaded", () => {
    // === Sabit kullanÄ±cÄ±lar ===
   const USERS = {
  "bulutkeles": {
    password: "Blt1995",   // Ã–zel karakter yok, TÃ¼rkÃ§e harf yok
    name: "Bulut KeleÅŸ",
    role: "Co-Founder Â· Tech & Growth",
    color: "var(--accent1)"
  },
  "busrakaraca": {
    password: "Busra95",   // Å yok
    name: "BÃ¼ÅŸra Karaca",
    role: "Co-Founder Â· Creative & Ops",
    color: "var(--accent2)"
  },
  "eminekaraca": {
    password: "Emine95",
    name: "Emine Karaca",
    role: "Community & Content",
    color: "linear-gradient(135deg,#22c55e,#0ea5e9)"
  }
};


    let currentUser = null;

    const notesFeed   = document.getElementById("notesFeed");
    const loginForm   = document.getElementById("loginForm");
    const loginError  = document.getElementById("loginError");
    const notesLogin  = document.getElementById("notesLogin");
    const notesAdmin  = document.getElementById("notesAdmin");
    const adminAvatar = document.getElementById("adminAvatar");
    const adminHello  = document.getElementById("adminHello");
    const adminRole   = document.getElementById("adminRole");
    const noteForm    = document.getElementById("noteForm");
    const noteText    = document.getElementById("noteText");
    const noteImageUrl = document.getElementById("noteImageUrl");
    const editingIdEl = document.getElementById("editingId");

    function escapeHtml(str) {
      return String(str)
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;");
    }

    // === Firestore'dan notlarÄ± Ã§ek ===
       // === Firestore'dan notlarÄ± Ã§ek (sadece veri hazÄ±rlasÄ±n) ===
    async function loadNotes() {
      // createdAt alanÄ±na gÃ¶re tersten sÄ±rala
      const q = query(notesColRef, orderBy("createdAt", "desc"));
      const snap = await getDocs(q);

      const notes = [];

      for (const docSnap of snap.docs) {
        const data = docSnap.data();
        const id   = docSnap.id;

        // alt koleksiyonlar: likes & comments
        const likesRef    = collection(db, "morpheraNotes", id, "likes");
        const commentsRef = collection(db, "morpheraNotes", id, "comments");

        const [likesSnap, commentsSnap] = await Promise.all([
          getDocs(likesRef),
          getDocs(commentsRef)
        ]);

        notes.push({
          id,
          ...data,
          likeCount: likesSnap.size,
          commentCount: commentsSnap.size
        });
      }

      return notes;
    }

function attachInteractionEvents() {
  document.querySelectorAll("[data-like]").forEach(btn => {
    btn.addEventListener("click", () => {
      const noteId = btn.dataset.like;
      const name = prompt("Ad Soyad:");
      if (name) addLike(noteId, name);
    });

  document.querySelectorAll("[data-toggle-comment]").forEach(btn => {
    btn.addEventListener("click", () => {
      const noteId = btn.dataset.toggleComment;
      document.getElementById(`commentBox-${noteId}`).classList.toggle("hidden");
    });
  });

  document.querySelectorAll("[data-send-comment]").forEach(btn => {
    btn.addEventListener("click", () => {
      const noteId = btn.dataset.sendComment;
      const name = document.getElementById(`commentName-${noteId}`).value.trim();
      const text = document.getElementById(`commentText-${noteId}`).value.trim();

      if (!name || !text) return alert("LÃ¼tfen adÄ±nÄ±zÄ± ve yorumunuzu yazÄ±n.");

      addComment(noteId, name, text);
    });
  });
}


    // === NotlarÄ± duvara Ã§iz ===
    async function renderNotes() {
  const notes = await loadNotes();

  if (!notes.length) {
    notesFeed.innerHTML = `
      <div class="note-card note-card--empty">
        <p>HenÃ¼z bir not bÄ±rakÄ±lmamÄ±ÅŸ. Ä°lk notu ekipten biri yazdÄ±ÄŸÄ±nda burada gÃ¶rÃ¼necek.</p>
      </div>
    `;
    return;
  }

  notesFeed.innerHTML = notes.map(note => {
    const isMine = currentUser && note.authorKey === currentUser.username;
    const date = note.createdAt?.toDate?.() || new Date();
    const ts = date.toLocaleString("tr-TR", {
      day: "2-digit", month: "2-digit", year: "numeric",
      hour: "2-digit", minute: "2-digit"
    });

    return `
      <article class="note-card" data-id="${note.id}">
        <header class="note-card__header">
          <div class="note-card__avatar" style="background:${note.avatarBg}">
            <span>${note.authorInitials}</span>
          </div>
          <div class="note-card__meta">
            <div class="note-card__author">${note.authorName}</div>
            <div class="note-card__role">${note.authorRole}</div>
            <time class="note-card__time">${ts}</time>
          </div>

          ${isMine ? `
            <div class="note-card__actions">
              <button type="button" class="note-btn note-btn--ghost note-edit">DÃ¼zenle</button>
              <button type="button" class="note-btn note-btn--danger note-delete">Sil</button>
            </div>
          ` : ""}
        </header>

        <div class="note-card__body">
          <p>${escapeHtml(note.text || "").replace(/\n/g,"<br>")}</p>
          ${note.imageUrl ? `
            <figure class="note-card__figure">
              <img src="${note.imageUrl}" alt="" loading="lazy" />
            </figure>
          ` : ""}
        </div>

        <!-- BEÄENÄ° & YORUM -->
        <footer class="note-card__footer">
          <button class="note-like-btn" data-like="${note.id}">
            â¤ï¸ BeÄŸen (${note.likeCount})
          </button>

          <button class="note-comment-toggle" data-toggle-comment="${note.id}">
            ğŸ’¬ Yorum (${note.commentCount})
          </button>

          <div id="commentBox-${note.id}" class="comment-box hidden">
            <input id="commentName-${note.id}" placeholder="Ad Soyad" />
            <textarea id="commentText-${note.id}" placeholder="Yorumun..."></textarea>
            <button data-send-comment="${note.id}">GÃ¶nder</button>
          </div>
        </footer>
      </article>
    `;
  }).join("");

  attachInteractionEvents();
}


    // === LOGIN ===
    loginForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const formData = new FormData(loginForm);
      const username = String(formData.get("username") || "").trim();
      const password = String(formData.get("password") || "");

      const user = USERS[username];
      if (!user || user.password !== password) {
        loginError.textContent = "KullanÄ±cÄ± adÄ± veya ÅŸifre hatalÄ±.";
        return;
      }

      loginError.textContent = "";
      currentUser = { username, ...user };

      notesLogin.classList.add("hidden");
      notesAdmin.classList.remove("hidden");

      adminAvatar.style.background = user.color;
      adminAvatar.textContent = user.name.charAt(0).toUpperCase();
      adminHello.textContent = `Merhaba ${user.name}, Morpheradan Notlar paneline hoÅŸ geldin.`;
      adminRole.textContent  = user.role;

      renderNotes();
    });

    // === NOT EKLE / GÃœNCELLE ===
    noteForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      if (!currentUser) return;

      const text = noteText.value.trim();
      const img  = noteImageUrl.value.trim();
      if (!text) return;

      const editingId = editingIdEl.value;

      if (editingId) {
        const ref = doc(db, "morpheraNotes", editingId);
        await updateDoc(ref, {
          text,
          imageUrl: img || "",
          updatedAt: Date.now()
        });
        editingIdEl.value = "";
      } else {
        const initials = currentUser.name
          .split(" ")
          .map(p => p.charAt(0))
          .join("")
          .slice(0,2)
          .toUpperCase();

        await addDoc(notesColRef, {
          authorKey: currentUser.username,
          authorName: currentUser.name,
          authorRole: currentUser.role,
          authorInitials: initials,
          avatarBg: currentUser.color,
          text,
          imageUrl: img || "",
          createdAt: serverTimestamp()
        });
      }

      noteText.value = "";
      noteImageUrl.value = "";
      await renderNotes();
    });

    // === DÃœZENLE / SÄ°L (sadece kendi notlarÄ±nda) ===
    notesFeed.addEventListener("click", async (e) => {
      const target = e.target;
      if (!target.classList) return;

      const card = target.closest(".note-card");
      if (!card) return;

      const id = card.getAttribute("data-id");
      if (!id) return;

      const notes = await loadNotes();
      const note = notes.find(n => n.id === id);
      if (!note) return;
      if (!currentUser || note.authorKey !== currentUser.username) return;

      if (target.classList.contains("note-delete")) {
        if (confirm("Bu notu silmek istediÄŸine emin misin?")) {
          const ref = doc(db, "morpheraNotes", id);
          await deleteDoc(ref);
          await renderNotes();
        }
      }

      if (target.classList.contains("note-edit")) {
        noteText.value = note.text || "";
        noteImageUrl.value = note.imageUrl || "";
        editingIdEl.value = note.id;
        noteText.focus();
      }
    });

    // Sayfa aÃ§Ä±lÄ±nca herkese notlarÄ± gÃ¶ster (kimse login olmasa bile)
    renderNotes();
  });
</script>



</body>
</html>
